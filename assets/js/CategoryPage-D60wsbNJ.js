import{a as e,r as t,j as s,B as r,h as a,an as i,I as o,ao as n,ap as l,T as d,x as c,a7 as x,A as h,aq as p,ar as u,as as f,at as m,f as g,z as j,ab as b,au as y,av as w,aw as v,G as S,ax as C,k}from"./mui-CLbw_gaj.js";import{u as F,a as W,L as z}from"./index-CewhPaYI.js";import{c as _,u as I}from"./router-BiFerjYI.js";import"./vendor-HnKmhvXM.js";import"./utils-CeR3a_hx.js";const M=()=>{const{categoryId:M}=_(),L=I(),E=e("(max-width:768px)"),P=e("(max-width:1024px)"),{addToCart:A,isLoggedIn:R,login:N}=F(),[T,H]=t.useState(null),[D,B]=t.useState([]),[O,$]=t.useState([]),[q,G]=t.useState([]),[U,Y]=t.useState(!0),[Q,Z]=t.useState(!1),[J,K]=t.useState({open:!1,message:"",severity:"success"}),[V,X]=t.useState(null),[ee,te]=t.useState(!1),[se,re]=t.useState(null),[ae,ie]=t.useState(""),[oe,ne]=t.useState([0,1e5]),[le,de]=t.useState("newest"),[ce,xe]=t.useState("");t.useEffect(()=>{M&&he()},[M]),t.useEffect(()=>{pe()},[O,ae,oe,le,ce]);const he=async()=>{try{Y(!0);const e=await W.get("/categories"),t=e.data?.categories||[];B(t);const s=t.find(e=>e.category_id===M);H(s),ie(M);const r=await W.get(`/products?category_id=${M}`);$(r.data?.products||[])}catch(e){}finally{Y(!1)}},pe=async()=>{let e=[...O];if(ce.trim())try{const t=await W.get(`/search?q=${encodeURIComponent(ce.trim())}`);t.data?.success&&(e=t.data.products||[])}catch(t){const s=ce.toLowerCase().trim();e=e.filter(e=>e.name.toLowerCase().includes(s))}ae&&ae!==M&&(e=e.filter(e=>e.category_id===ae)),e=e.filter(e=>{const t=parseFloat(e.price)||0;return t>=oe[0]&&t<=oe[1]}),e.sort((e,t)=>{switch(le){case"price-low":return(parseFloat(e.price)||0)-(parseFloat(t.price)||0);case"price-high":return(parseFloat(t.price)||0)-(parseFloat(e.price)||0);case"name":return e.name.localeCompare(t.name);default:return new Date(t.created_at||0)-new Date(e.created_at||0)}}),G(e)},ue=async e=>{if(R){X(e.product_id);try{await A(e,1),K({open:!0,message:"Added to cart successfully!",severity:"success"})}catch(t){"LOGIN_REQUIRED"===t.message?Z(!0):K({open:!0,message:t.message||"Failed to add to cart",severity:"error"})}finally{X(null)}}else Z(!0)},fe=e=>{const t=e.target.value;ie(t),t&&t!==M&&"all"!==t&&L(`/category/${t}`)},me=(e,t)=>{ne(t)},ge=e=>{de(e.target.value)},je=e=>{xe(e.target.value)},be=()=>{ie(M),ne([0,1e5]),de("newest"),xe("")},ye=()=>s.jsxs(r,{sx:{width:P?320:380,p:3,height:"fit-content",position:"sticky",top:20},children:[s.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[s.jsx(d,{variant:"h6",sx:{fontWeight:600,fontFamily:'"Montserrat", sans-serif'},children:"Filters"}),s.jsx(a,{onClick:be,size:"small",sx:{textTransform:"none",color:"#e74c3c"},children:"Clear All"})]}),s.jsxs(p,{defaultExpanded:!0,sx:{mb:2,boxShadow:"none",border:"1px solid #eee"},children:[s.jsx(u,{expandIcon:s.jsx(f,{}),children:s.jsx(d,{sx:{fontWeight:500,fontFamily:'"Montserrat", sans-serif'},children:"Search Products"})}),s.jsx(m,{children:s.jsx(g,{fullWidth:!0,size:"small",placeholder:"Search by product name...",value:ce,onChange:je,InputProps:{startAdornment:s.jsx(j,{position:"start",children:s.jsx(b,{sx:{color:"text.secondary",fontSize:20}})})},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#ddd"},"&:hover fieldset":{borderColor:"#e74c3c"},"&.Mui-focused fieldset":{borderColor:"#e74c3c"}}}})})]}),s.jsxs(p,{defaultExpanded:!0,sx:{mb:2,boxShadow:"none",border:"1px solid #eee"},children:[s.jsx(u,{expandIcon:s.jsx(f,{}),children:s.jsx(d,{sx:{fontWeight:500,fontFamily:'"Montserrat", sans-serif'},children:"Category"})}),s.jsx(m,{children:s.jsxs(y,{fullWidth:!0,size:"small",children:[s.jsx(w,{children:"Select Category"}),s.jsxs(v,{value:ae,onChange:fe,label:"Select Category",children:[s.jsx(S,{value:"all",children:"All Products"}),D.map(e=>s.jsx(S,{value:e.category_id,children:e.category_name},e.category_id))]})]})})]}),s.jsxs(p,{defaultExpanded:!0,sx:{mb:2,boxShadow:"none",border:"1px solid #eee"},children:[s.jsx(u,{expandIcon:s.jsx(f,{}),children:s.jsx(d,{sx:{fontWeight:500,fontFamily:'"Montserrat", sans-serif'},children:"Price Range"})}),s.jsx(m,{children:s.jsxs(r,{sx:{px:1},children:[s.jsx(C,{value:oe,onChange:me,valueLabelDisplay:"auto",min:0,max:1e5,step:1e3,sx:{mb:2}}),s.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[s.jsxs(d,{variant:"body2",color:"text.secondary",sx:{fontFamily:'"Nunito Sans", sans-serif'},children:["₹",oe[0].toLocaleString()]}),s.jsxs(d,{variant:"body2",color:"text.secondary",sx:{fontFamily:'"Nunito Sans", sans-serif'},children:["₹",oe[1].toLocaleString()]})]})]})})]}),s.jsxs(p,{defaultExpanded:!0,sx:{mb:2,boxShadow:"none",border:"1px solid #eee"},children:[s.jsx(u,{expandIcon:s.jsx(f,{}),children:s.jsx(d,{sx:{fontWeight:500,fontFamily:'"Montserrat", sans-serif'},children:"Sort By"})}),s.jsx(m,{children:s.jsx(y,{fullWidth:!0,size:"small",children:s.jsxs(v,{value:le,onChange:ge,children:[s.jsx(S,{value:"newest",children:"Newest First"}),s.jsx(S,{value:"price-low",children:"Price: Low to High"}),s.jsx(S,{value:"price-high",children:"Price: High to Low"}),s.jsx(S,{value:"name",children:"Name: A to Z"})]})})})]})]});return U?s.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:s.jsx(r,{sx:{width:20,height:20,border:"2px solid #333",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):s.jsxs(r,{sx:{width:"100%",maxWidth:1600,mx:"auto",mt:4,px:{xs:1,sm:2,md:3}},children:[s.jsxs(r,{sx:{mb:4},children:[s.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[s.jsx(a,{startIcon:s.jsx(i,{}),onClick:()=>L("/"),sx:{color:"#333",textTransform:"none"},children:"Back to Home"}),E&&"153236582156"!==M&&s.jsxs(r,{sx:{display:"flex",gap:1},children:[s.jsx(o,{onClick:()=>te(!0),sx:{color:"#333"},children:s.jsx(n,{})}),s.jsx(o,{sx:{color:"#333"},children:s.jsx(l,{})})]})]}),s.jsx(d,{variant:"h5",sx:{fontWeight:600,color:"#222",fontFamily:'"Montserrat", sans-serif',fontSize:{xs:"1.2rem",sm:"1.5rem"},mb:1},children:T?.name||"Category Products"}),s.jsxs(d,{variant:"body2",color:"text.secondary",sx:{mb:3,fontFamily:'"Nunito Sans", sans-serif'},children:[q.length," product",1!==q.length?"s":""," found"]})]}),s.jsxs(r,{sx:{display:"flex",gap:{xs:0,sm:2,md:3}},children:[!E&&"153236582156"!==M&&ye(),s.jsx(r,{sx:{flex:1,minWidth:0},children:q.length>0?s.jsx(r,{sx:{display:"grid",gridTemplateColumns:"153236582156"===M?{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}:"none",gap:{xs:1,sm:2,md:3},justifyContent:"center",..."153236582156"!==M&&{display:"flex",flexWrap:"wrap",gap:{xs:.5,sm:2},justifyContent:"flex-start"}},children:q.map(e=>(e=>{const t=parseFloat(e.original_price)||0,i=parseFloat(e.price)||0,n=t>0&&i<t?Math.round((t-i)/t*100):0,l=`https://sardarfashions.mycartly.in/uploads/products/1532365/${e.product_id}`,c=l+"_v1.png",x=l+"_v2.png",h=()=>{L(`/product/${e.product_id}`)};return"153236582156"===M?s.jsx(r,{sx:{width:"100%",position:"relative",borderRadius:2,overflow:"hidden",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15)"}},children:s.jsxs(r,{sx:{position:"relative",width:"100%",height:E?250:400,backgroundImage:`url(${c})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",display:"flex",alignItems:"flex-end",justifyContent:"flex-end",p:2,cursor:"pointer"},onClick:h,onMouseEnter:()=>re(e.product_id),onMouseLeave:()=>re(null),children:[s.jsx(r,{sx:{position:"absolute",bottom:0,left:0,right:0,height:"60%",background:"linear-gradient(transparent, rgba(0,0,0,0.8))",zIndex:1}}),n>0&&s.jsxs(r,{sx:{position:"absolute",top:8,left:8,backgroundColor:"#e74c3c",color:"white",px:1,py:.5,borderRadius:1,fontSize:"0.7rem",fontWeight:600,fontFamily:"Montserrat, sans-serif",zIndex:2},children:["-",n,"%"]}),s.jsxs(r,{sx:{position:"relative",zIndex:2,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1,maxWidth:"70%"},children:[s.jsx(d,{sx:{fontFamily:'"Montserrat", sans-serif',fontWeight:600,fontSize:E?12:14,color:"white",textAlign:"right",textTransform:"uppercase",letterSpacing:.5,textShadow:"0 2px 4px rgba(0,0,0,0.7)",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.name}),s.jsxs(d,{sx:{fontFamily:'"Montserrat", sans-serif',fontWeight:700,fontSize:E?14:16,color:"white",textShadow:"0 2px 4px rgba(0,0,0,0.7)"},children:["₹",i.toLocaleString()]}),s.jsx(a,{variant:"contained",size:"small",onClick:t=>{t.stopPropagation(),ue(e)},disabled:V===e.product_id,sx:{background:"linear-gradient(135deg, #E91E63 0%, #C2185B 100%)",color:"white",fontWeight:600,textTransform:"none",fontSize:E?"0.7rem":"0.8rem",px:2,py:.5,borderRadius:2,boxShadow:"0 2px 8px rgba(233, 30, 99, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{background:"linear-gradient(135deg, #C2185B 0%, #AD1457 100%)",boxShadow:"0 4px 12px rgba(233, 30, 99, 0.4)",transform:"translateY(-1px)"},"&:disabled":{background:"linear-gradient(135deg, #e0e0e0 0%, #bdbdbd 100%)",color:"#666",boxShadow:"none",transform:"none"}},children:V===e.product_id?"Adding...":"Add to Cart"})]})]})},e.product_id):s.jsxs(r,{sx:{width:E?"calc(50% - 4px)":"280px",maxWidth:E?"calc(50% - 4px)":"280px",flexShrink:0,textAlign:"center",p:.5,overflow:"hidden",position:"relative"},children:[s.jsxs(r,{sx:{position:"relative",width:"100%",height:E?160:280,mb:1,borderRadius:2,overflow:"hidden",cursor:"pointer"},onClick:h,onMouseEnter:()=>re(e.product_id),onMouseLeave:()=>re(null),children:[s.jsx("img",{className:"v1-img",src:c,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain",maxWidth:"100%",maxHeight:"100%",transition:"opacity 0.3s ease"},onError:e=>{e.target.style.display="none"}}),s.jsx("img",{className:"v2-img",src:x,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain",maxWidth:"100%",maxHeight:"100%",position:"absolute",top:0,left:0,opacity:se===e.product_id?1:0,visibility:se===e.product_id?"visible":"hidden",transition:"opacity 0.3s ease, visibility 0.3s ease"},onError:e=>{e.target.style.opacity="0",e.target.style.visibility="hidden"}}),n>0&&s.jsxs(r,{sx:{position:"absolute",top:8,left:8,backgroundColor:"#e74c3c",color:"white",px:1,py:.5,borderRadius:1,fontSize:"0.7rem",fontWeight:600,fontFamily:"Montserrat, sans-serif",zIndex:1},children:["-",n,"%"]}),s.jsx(o,{onClick:t=>{t.stopPropagation(),ue(e)},disabled:V===e.product_id,sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(255,255,255,0.9)",color:"#333",width:32,height:32,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"},"&:disabled":{opacity:.7}},children:V===e.product_id?s.jsx(r,{sx:{width:18,height:18,border:"2px solid #333",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):s.jsx(k,{sx:{fontSize:18}})})]}),s.jsx(d,{sx:{fontSize:{xs:11,sm:14},fontWeight:500,color:"#333",mb:.5,lineHeight:1.3,fontFamily:'"Montserrat", sans-serif',textTransform:"uppercase",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",wordBreak:"break-word",width:"100%",maxWidth:"100%",minHeight:"40px"},children:e.name}),s.jsx(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:.5},children:n>0?s.jsxs(s.Fragment,{children:[s.jsxs(d,{sx:{fontSize:{xs:10,sm:12},color:"#999",textDecoration:"line-through",fontFamily:'"Nunito Sans", sans-serif'},children:["₹",t.toLocaleString()]}),s.jsxs(d,{sx:{fontSize:{xs:12,sm:16},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})]}):s.jsxs(d,{sx:{fontSize:{xs:12,sm:16},fontWeight:700,color:"#333",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})})]},e.product_id)})(e))}):s.jsxs(r,{sx:{textAlign:"center",py:8,color:"text.secondary"},children:[s.jsx(d,{variant:"h6",sx:{mb:2,fontFamily:'"Montserrat", sans-serif'},children:"No products found with current filters"}),s.jsx(d,{variant:"body1",sx:{fontFamily:'"Nunito Sans", sans-serif'},children:"Try adjusting your filters or check back later!"})]})})]}),s.jsx(c,{anchor:"left",open:ee,onClose:()=>te(!1),PaperProps:{sx:{width:P?320:380}},children:ye()}),s.jsx(z,{open:Q,onClose:()=>Z(!1),onLoginSuccess:e=>{Z(!1),N(e)},message:"Please login to add items to cart"}),s.jsx(x,{open:J.open,autoHideDuration:3e3,onClose:()=>K({...J,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:s.jsx(h,{onClose:()=>K({...J,open:!1}),severity:J.severity,sx:{width:"100%"},children:J.message})}),s.jsx("style",{jsx:!0,children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};export{M as default};
