import{a as e,r as s,j as t,B as r,I as o,ao as i,f as n,z as a,ac as l,C as c,T as d,a7 as x,A as p,a9 as h,k as m}from"./mui-B2Ut1MEh.js";import{u,a as f,L as g}from"./index-BKo2lhCp.js";import{d as j,u as y}from"./router-DlIYArQ-.js";import"./vendor-HnKmhvXM.js";import"./utils-BbBA5CLU.js";const b=()=>{const[b,v]=j(),S=y(),w=e("(max-width:768px)"),{addToCart:C,isLoggedIn:k,login:z}=u(),[I,F]=s.useState(b.get("q")||""),[W,M]=s.useState([]),[O,_]=s.useState(!1),[L,T]=s.useState(!1),[$,D]=s.useState({open:!1,message:"",severity:"success"}),[R,A]=s.useState(null),[B,E]=s.useState(!1);s.useEffect(()=>{const e=b.get("q");e&&e.trim()&&(F(e),H(e))},[b]);const H=async e=>{if(!e.trim())return M([]),void E(!1);_(!0),E(!0);try{const s=await f.get(`/search?q=${encodeURIComponent(e.trim())}`);s.data?.success?M(s.data.products||[]):(M([]),D({open:!0,message:s.data?.error||"Search failed",severity:"error"}))}catch(s){M([]),D({open:!0,message:"Failed to search products. Please try again.",severity:"error"})}finally{_(!1)}},N=e=>{const s=`https://sardarfashions.mycartly.in/uploads/products/1532365/${e.product_id}`+"_v1.png",i=e.price||0,n=e.base_price||i,a=n>i?Math.round((n-i)/n*100):0;return t.jsxs(r,{sx:{display:"flex",flexDirection:"column",cursor:"pointer",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)"}},children:[t.jsxs(r,{sx:{position:"relative",width:"100%",height:w?200:300,mb:1,overflow:"hidden",cursor:"pointer"},onClick:()=>P(e.product_id),children:[t.jsx("img",{className:"v1-img",src:s,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover",maxWidth:"100%",maxHeight:"100%",transition:"opacity 0.3s ease"},onError:e=>{e.target.style.display="none"}}),a>0&&t.jsx(r,{sx:{position:"absolute",top:12,left:12,backgroundColor:"#000000",color:"white",px:2,py:1,borderRadius:1,fontSize:"0.75rem",fontWeight:600,fontFamily:"Montserrat, sans-serif",zIndex:1,textTransform:"uppercase",letterSpacing:.5},children:"Sale"}),t.jsxs(r,{sx:{position:"absolute",bottom:12,right:12,display:"flex",gap:.5,zIndex:2},children:[t.jsx(o,{onClick:s=>{s.stopPropagation(),P(e.product_id)},sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"}},children:t.jsx(h,{sx:{fontSize:20}})}),t.jsx(o,{onClick:s=>{s.stopPropagation(),(async e=>{if(k){A(e.product_id);try{await C(e,1),D({open:!0,message:"Added to cart successfully!",severity:"success"})}catch(s){"LOGIN_REQUIRED"===s.message?T(!0):D({open:!0,message:s.message||"Failed to add to cart",severity:"error"})}finally{A(null)}}else T(!0)})(e)},disabled:R===e.product_id,sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"},"&:disabled":{opacity:.7}},children:R===e.product_id?t.jsx(r,{sx:{width:20,height:20,border:"2px solid #333",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):t.jsx(m,{sx:{fontSize:20}})})]})]}),t.jsx(d,{sx:{fontSize:{xs:12,sm:16},fontWeight:500,color:"#333",mb:.5,lineHeight:1.3,fontFamily:'"Montserrat", sans-serif',textTransform:"uppercase",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word",width:"100%",maxWidth:"100%",minHeight:"40px"},children:e.name}),t.jsx(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:.5,mb:1},children:a>0?t.jsxs(t.Fragment,{children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsxs(d,{sx:{fontSize:{xs:11,sm:14},color:"#999",textDecoration:"line-through",fontFamily:'"Nunito Sans", sans-serif'},children:["₹",n.toLocaleString()]}),t.jsxs(d,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})]}),t.jsxs(d,{sx:{fontSize:{xs:10,sm:12},color:"#e74c3c",fontWeight:600,fontFamily:'"Montserrat", sans-serif'},children:[a,"% OFF"]})]}):t.jsxs(d,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})})]},e.product_id)},P=e=>{S(`/product/${e}`)};return t.jsxs(r,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa"},children:[t.jsx(r,{sx:{bgcolor:"#fff",borderBottom:"1px solid #e0e0e0",py:2,px:{xs:2,md:4}},children:t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,maxWidth:1200,mx:"auto"},children:[t.jsx(o,{onClick:()=>S(-1),sx:{color:"#666"},children:t.jsx(i,{})}),t.jsx(r,{component:"form",onSubmit:e=>{e.preventDefault(),I.trim()&&(v({q:I.trim()}),H(I.trim()))},sx:{flex:1},children:t.jsx(n,{fullWidth:!0,placeholder:"Search for products...",value:I,onChange:e=>{F(e.target.value)},InputProps:{startAdornment:t.jsx(a,{position:"start",children:t.jsx(l,{sx:{color:"#666"}})}),sx:{bgcolor:"#f5f5f5",borderRadius:2,"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"2px solid #e74c3c"}}},sx:{"& .MuiInputBase-input":{py:1.5,fontSize:"1rem"}}})})]})}),t.jsxs(r,{sx:{maxWidth:1200,mx:"auto",px:{xs:2,md:4},py:4},children:[O&&t.jsx(r,{sx:{display:"flex",justifyContent:"center",py:4},children:t.jsx(c,{})}),!O&&B&&t.jsxs(t.Fragment,{children:[t.jsx(d,{variant:"h6",sx:{mb:3,fontWeight:600},children:W.length>0?`Found ${W.length} product${1!==W.length?"s":""} for "${I}"`:`No products found for "${I}"`}),0===W.length?t.jsxs(r,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(d,{variant:"h6",sx:{color:"#666",mb:1},children:"No products found"}),t.jsx(d,{variant:"body2",sx:{color:"#999"},children:"Try searching with different keywords"})]}):t.jsx(r,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:2,sm:3},maxWidth:1200,mx:"auto"},children:W.map(e=>N(e))})]}),!O&&!B&&t.jsxs(r,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(d,{variant:"h6",sx:{color:"#666",mb:1},children:"Search for products"}),t.jsx(d,{variant:"body2",sx:{color:"#999"},children:"Enter a product name or description to find what you're looking for"})]})]}),t.jsx(g,{open:L,onClose:()=>T(!1),onLoginSuccess:e=>{T(!1),z(e)},message:"Please login to add items to cart"}),t.jsx(x,{open:$.open,autoHideDuration:4e3,onClose:()=>D({...$,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(p,{onClose:()=>D({...$,open:!1}),severity:$.severity,sx:{width:"100%"},children:$.message})}),t.jsx("style",{jsx:!0,children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};export{b as default};
