import{a as e,r as s,j as t,B as o,I as r,ao as i,f as n,z as a,av as l,C as d,T as c,a7 as x,A as p,a9 as h,k as u}from"./mui-vugdBkEW.js";import{u as m,a as g,L as f,b}from"./index-BqFA0KlC.js";import{c as j,u as y}from"./router-BDbEWt86.js";import"./vendor-HnKmhvXM.js";import"./utils-BuJOX08E.js";const v=()=>{const[v,S]=j(),w=y(),C=e("(max-width:768px)"),{addToCart:k,isLoggedIn:z,login:F}=m(),[I,W]=s.useState(v.get("q")||""),[M,O]=s.useState([]),[_,L]=s.useState(!1),[T,H]=s.useState(!1),[$,A]=s.useState({open:!1,message:"",severity:"success"}),[B,D]=s.useState(null),[P,R]=s.useState(!1),[q,E]=s.useState(null);s.useEffect(()=>{const e=v.get("q");e&&e.trim()&&(W(e),N(e))},[v]);const N=async e=>{if(!e.trim())return O([]),void R(!1);L(!0),R(!0);try{const s=await g.get(`/search?q=${encodeURIComponent(e.trim())}`);s.data?.success?O(s.data.products||[]):(O([]),A({open:!0,message:s.data?.error||"Search failed",severity:"error"}))}catch(s){O([]),A({open:!0,message:"Failed to search products. Please try again.",severity:"error"})}finally{L(!1)}},U=e=>{const s=e.images&&e.images.length>0?e.images[0]:null,i=e.images&&e.images.length>1?e.images[1]:s,n=e.price||0,a=e.base_price||n,l=a>n?Math.round((a-n)/a*100):0;return t.jsxs(o,{onClick:()=>K(e.product_id),sx:{display:"flex",flexDirection:"column",cursor:"pointer",transition:"all 0.3s ease",borderRadius:2,p:1,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.1)"}},children:[t.jsxs(o,{sx:{position:"relative",width:"100%",height:C?200:300,mb:1,overflow:"hidden",cursor:"pointer"},onMouseEnter:()=>E(e.product_id),onMouseLeave:()=>E(null),children:[t.jsx(b,{src:s,alt:e.name,height:"100%",sx:{width:"100%",height:"100%",objectFit:"cover",maxWidth:"100%",maxHeight:"100%",transition:"opacity 0.3s ease",position:"absolute",top:0,left:0,zIndex:1},placeholder:"Loading..."}),t.jsx(b,{src:i,alt:e.name,height:"100%",sx:{width:"100%",height:"100%",objectFit:"cover",maxWidth:"100%",maxHeight:"100%",position:"absolute",top:0,left:0,opacity:q===e.product_id?1:0,visibility:q===e.product_id?"visible":"hidden",transition:"opacity 0.3s ease, visibility 0.3s ease",zIndex:2},placeholder:"Loading..."}),l>0&&t.jsx(o,{sx:{position:"absolute",top:12,left:12,backgroundColor:"#000000",color:"white",px:2,py:1,borderRadius:1,fontSize:"0.75rem",fontWeight:600,fontFamily:"Montserrat, sans-serif",zIndex:1,textTransform:"uppercase",letterSpacing:.5},children:"Sale"}),t.jsxs(o,{sx:{position:"absolute",bottom:12,right:12,display:"flex",gap:.5,zIndex:2},children:[t.jsx(r,{onClick:s=>{s.stopPropagation(),K(e.product_id)},sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"}},children:t.jsx(h,{sx:{fontSize:20}})}),t.jsx(r,{onClick:s=>{s.stopPropagation(),(async e=>{D(e.product_id);try{await k(e,1),A({open:!0,message:"Added to cart successfully!",severity:"success"})}catch(s){"OUT_OF_STOCK"===s.message?A({open:!0,message:"Sorry, this product is currently out of stock",severity:"warning"}):A({open:!0,message:s.message||"Failed to add to cart",severity:"error"})}finally{D(null)}})(e)},disabled:B===e.product_id,sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"},"&:disabled":{opacity:.7}},children:B===e.product_id?t.jsx(o,{sx:{width:20,height:20,border:"2px solid #333",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):t.jsx(u,{sx:{fontSize:20}})})]})]}),t.jsx(c,{sx:{fontSize:{xs:12,sm:16},fontWeight:500,color:"#333",mb:.5,lineHeight:1.3,fontFamily:'"Montserrat", sans-serif',textTransform:"uppercase",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word",width:"100%",maxWidth:"100%",minHeight:"40px"},children:e.name}),t.jsx(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:.5,mb:1},children:l>0?t.jsxs(t.Fragment,{children:[t.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsxs(c,{sx:{fontSize:{xs:11,sm:14},color:"#999",textDecoration:"line-through",fontFamily:'"Nunito Sans", sans-serif'},children:["₹",a.toLocaleString()]}),t.jsxs(c,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",n.toLocaleString()]})]}),t.jsxs(c,{sx:{fontSize:{xs:10,sm:12},color:"#e74c3c",fontWeight:600,fontFamily:'"Montserrat", sans-serif'},children:[l,"% OFF"]})]}):t.jsxs(c,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",n.toLocaleString()]})})]},e.product_id)},K=e=>{w(`/product/${e}`)};return t.jsxs(o,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa"},children:[t.jsx(o,{sx:{bgcolor:"#fff",borderBottom:"1px solid #e0e0e0",py:2,px:{xs:2,md:4}},children:t.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,maxWidth:1200,mx:"auto"},children:[t.jsx(r,{onClick:()=>w(-1),sx:{color:"#666"},children:t.jsx(i,{})}),t.jsx(o,{component:"form",onSubmit:e=>{e.preventDefault(),I.trim()&&(S({q:I.trim()}),N(I.trim()))},sx:{flex:1},children:t.jsx(n,{fullWidth:!0,placeholder:"Search for products...",value:I,onChange:e=>{W(e.target.value)},InputProps:{startAdornment:t.jsx(a,{position:"start",children:t.jsx(l,{sx:{color:"#666"}})}),sx:{bgcolor:"#f5f5f5",borderRadius:2,"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"2px solid #e74c3c"}}},sx:{"& .MuiInputBase-input":{py:1.5,fontSize:"1rem"}}})})]})}),t.jsxs(o,{sx:{maxWidth:1200,mx:"auto",px:{xs:2,md:4},py:4},children:[_&&t.jsx(o,{sx:{display:"flex",justifyContent:"center",py:4},children:t.jsx(d,{})}),!_&&P&&t.jsxs(t.Fragment,{children:[t.jsx(c,{variant:"h6",sx:{mb:3,fontWeight:600},children:M.length>0?`Found ${M.length} product${1!==M.length?"s":""} for "${I}"`:`No products found for "${I}"`}),0===M.length?t.jsxs(o,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(c,{variant:"h6",sx:{color:"#666",mb:1},children:"No products found"}),t.jsx(c,{variant:"body2",sx:{color:"#999"},children:"Try searching with different keywords"})]}):t.jsx(o,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:2,sm:3},maxWidth:1200,mx:"auto"},children:M.map(e=>U(e))})]}),!_&&!P&&t.jsxs(o,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(c,{variant:"h6",sx:{color:"#666",mb:1},children:"Search for products"}),t.jsx(c,{variant:"body2",sx:{color:"#999"},children:"Enter a product name or description to find what you're looking for"})]})]}),t.jsx(f,{open:T,onClose:()=>H(!1),onLoginSuccess:e=>{H(!1),F(e)},message:"Please login to add items to cart"}),t.jsx(x,{open:$.open,autoHideDuration:4e3,onClose:()=>A({...$,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(p,{onClose:()=>A({...$,open:!1}),severity:$.severity,sx:{width:"100%"},children:$.message})}),t.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};export{v as default};
