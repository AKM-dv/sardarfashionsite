import{a as e,r as s,j as t,B as r,I as o,aq as i,f as n,z as a,ac as l,C as c,T as d,a7 as x,A as p,a9 as h,k as m}from"./mui-CYltanDZ.js";import{u,a as g,L as f}from"./index-DF1dA_K7.js";import{d as j,u as y}from"./router-Bir15TBb.js";import"./vendor-HnKmhvXM.js";import"./utils-CSgk65FE.js";const b=()=>{const[b,S]=j(),v=y(),w=e("(max-width:768px)"),{addToCart:C,isLoggedIn:k,login:z}=u(),[F,W]=s.useState(b.get("q")||""),[I,O]=s.useState([]),[M,T]=s.useState(!1),[_,L]=s.useState(!1),[$,q]=s.useState({open:!1,message:"",severity:"success"}),[A,B]=s.useState(null),[D,H]=s.useState(!1);s.useEffect(()=>{const e=b.get("q");e&&e.trim()&&(W(e),P(e))},[b]);const P=async e=>{if(!e.trim())return O([]),void H(!1);T(!0),H(!0);try{const s=await g.get(`/search?q=${encodeURIComponent(e.trim())}`);s.data?.success?O(s.data.products||[]):(O([]),q({open:!0,message:s.data?.error||"Search failed",severity:"error"}))}catch(s){O([]),q({open:!0,message:"Failed to search products. Please try again.",severity:"error"})}finally{T(!1)}},R=e=>{const s=e.images&&e.images.length>0?e.images[0]:null;e.images&&e.images.length>1&&e.images[1];const i=e.price||0,n=e.base_price||i,a=n>i?Math.round((n-i)/n*100):0;return t.jsxs(r,{onClick:()=>N(e.product_id),sx:{display:"flex",flexDirection:"column",cursor:"pointer",transition:"all 0.3s ease",borderRadius:2,p:1,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.1)"}},children:[t.jsxs(r,{sx:{position:"relative",width:"100%",height:w?200:300,mb:1,overflow:"hidden",cursor:"pointer"},children:[t.jsx("img",{className:"v1-img",src:s,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover",maxWidth:"100%",maxHeight:"100%",transition:"opacity 0.3s ease"},onError:e=>{e.target.style.display="none"}}),a>0&&t.jsx(r,{sx:{position:"absolute",top:12,left:12,backgroundColor:"#000000",color:"white",px:2,py:1,borderRadius:1,fontSize:"0.75rem",fontWeight:600,fontFamily:"Montserrat, sans-serif",zIndex:1,textTransform:"uppercase",letterSpacing:.5},children:"Sale"}),t.jsxs(r,{sx:{position:"absolute",bottom:12,right:12,display:"flex",gap:.5,zIndex:2},children:[t.jsx(o,{onClick:s=>{s.stopPropagation(),N(e.product_id)},sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"}},children:t.jsx(h,{sx:{fontSize:20}})}),t.jsx(o,{onClick:s=>{s.stopPropagation(),(async e=>{B(e.product_id);try{await C(e,1),q({open:!0,message:"Added to cart successfully!",severity:"success"})}catch(s){"OUT_OF_STOCK"===s.message?q({open:!0,message:"Sorry, this product is currently out of stock",severity:"warning"}):q({open:!0,message:s.message||"Failed to add to cart",severity:"error"})}finally{B(null)}})(e)},disabled:A===e.product_id,sx:{backgroundColor:"rgba(255,255,255,0.95)",color:"#333",width:36,height:36,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"},"&:disabled":{opacity:.7}},children:A===e.product_id?t.jsx(r,{sx:{width:20,height:20,border:"2px solid #333",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):t.jsx(m,{sx:{fontSize:20}})})]})]}),t.jsx(d,{sx:{fontSize:{xs:12,sm:16},fontWeight:500,color:"#333",mb:.5,lineHeight:1.3,fontFamily:'"Montserrat", sans-serif',textTransform:"uppercase",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word",width:"100%",maxWidth:"100%",minHeight:"40px"},children:e.name}),t.jsx(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:.5,mb:1},children:a>0?t.jsxs(t.Fragment,{children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsxs(d,{sx:{fontSize:{xs:11,sm:14},color:"#999",textDecoration:"line-through",fontFamily:'"Nunito Sans", sans-serif'},children:["₹",n.toLocaleString()]}),t.jsxs(d,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})]}),t.jsxs(d,{sx:{fontSize:{xs:10,sm:12},color:"#e74c3c",fontWeight:600,fontFamily:'"Montserrat", sans-serif'},children:[a,"% OFF"]})]}):t.jsxs(d,{sx:{fontSize:{xs:14,sm:18},fontWeight:700,color:"#e74c3c",fontFamily:'"Montserrat", sans-serif'},children:["₹",i.toLocaleString()]})})]},e.product_id)},N=e=>{v(`/product/${e}`)};return t.jsxs(r,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa"},children:[t.jsx(r,{sx:{bgcolor:"#fff",borderBottom:"1px solid #e0e0e0",py:2,px:{xs:2,md:4}},children:t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,maxWidth:1200,mx:"auto"},children:[t.jsx(o,{onClick:()=>v(-1),sx:{color:"#666"},children:t.jsx(i,{})}),t.jsx(r,{component:"form",onSubmit:e=>{e.preventDefault(),F.trim()&&(S({q:F.trim()}),P(F.trim()))},sx:{flex:1},children:t.jsx(n,{fullWidth:!0,placeholder:"Search for products...",value:F,onChange:e=>{W(e.target.value)},InputProps:{startAdornment:t.jsx(a,{position:"start",children:t.jsx(l,{sx:{color:"#666"}})}),sx:{bgcolor:"#f5f5f5",borderRadius:2,"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"2px solid #e74c3c"}}},sx:{"& .MuiInputBase-input":{py:1.5,fontSize:"1rem"}}})})]})}),t.jsxs(r,{sx:{maxWidth:1200,mx:"auto",px:{xs:2,md:4},py:4},children:[M&&t.jsx(r,{sx:{display:"flex",justifyContent:"center",py:4},children:t.jsx(c,{})}),!M&&D&&t.jsxs(t.Fragment,{children:[t.jsx(d,{variant:"h6",sx:{mb:3,fontWeight:600},children:I.length>0?`Found ${I.length} product${1!==I.length?"s":""} for "${F}"`:`No products found for "${F}"`}),0===I.length?t.jsxs(r,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(d,{variant:"h6",sx:{color:"#666",mb:1},children:"No products found"}),t.jsx(d,{variant:"body2",sx:{color:"#999"},children:"Try searching with different keywords"})]}):t.jsx(r,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:2,sm:3},maxWidth:1200,mx:"auto"},children:I.map(e=>R(e))})]}),!M&&!D&&t.jsxs(r,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{sx:{fontSize:64,color:"#ccc",mb:2}}),t.jsx(d,{variant:"h6",sx:{color:"#666",mb:1},children:"Search for products"}),t.jsx(d,{variant:"body2",sx:{color:"#999"},children:"Enter a product name or description to find what you're looking for"})]})]}),t.jsx(f,{open:_,onClose:()=>L(!1),onLoginSuccess:e=>{L(!1),z(e)},message:"Please login to add items to cart"}),t.jsx(x,{open:$.open,autoHideDuration:4e3,onClose:()=>q({...$,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(p,{onClose:()=>q({...$,open:!1}),severity:$.severity,sx:{width:"100%"},children:$.message})}),t.jsx("style",{jsx:!0,children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};export{b as default};
